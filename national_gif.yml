
packages:
  - sp
  - maps
  - maptools
  - rgeos
  - readr
  - stringr
  - dataRetrieval
  - lubridate
  - dplyr
  - mapdata
  - jsonlite
  - scipiper

sources:
  - scripts/gifs/map_utils.R
  - scripts/gifs/data_utils.R
  - scripts/gifs/draw_utils.R

file_extensions:
  - "ind"

targets:
  all: 
    depends: 
      - gifs/US_total_use.gif
      - gifs/US_therm_use.gif
      - gifs/US_irr_use.gif
      - gifs/US_pub_use.gif
      - gifs/US_pie_use.gif
  
  plot_metadata:
    command: c(I(13.33), I(7.5), I(200))
  
  proj: 
    command: c(I("+proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m +no_defs"))
    
  us_states:
    command: shifted_topojson("cache/state_boundaries_mobile.json", proj.string = proj)
    
  us_counties:
    command: shifted_topojson("cache/county_boundaries_mobile.json", proj.string = proj)
    
  county_dots:
    command: get_state_dots('cache/county_centroids_USA.json', 
      proj.string = proj,
      'cache/county_centroids_wu.tsv', state_totals = state_totals)
    
  us_county_dots:
    command: shift_centroids(county_dots, proj.string = proj)

  state_totals:
    command: get_us_totals('cache/wu_data_15_sum.json')

  plot_layout:
    command: get_national_layout(us_states, plot_metadata)

  gifs/US_total_use.gif:
    command: build_wu_gif(us_states, us_counties, us_county_dots, state_totals, plot_layout, 
      'images/usgs_logo_black.png', 
      target_name, frames = I(4), I('total'), I('thermoelectric'), pause_delay = I('100250'))
      
  gifs/US_therm_use.gif:
    command: build_wu_gif(us_states, us_counties, us_county_dots, state_totals, plot_layout, 
      'images/usgs_logo_black.png', 
      target_name, frames = I(4), I('thermoelectric'), I('irrigation'), pause_delay = I('100250'))
      
  gifs/US_irr_use.gif:
    command: build_wu_gif(us_states, us_counties, us_county_dots, state_totals, plot_layout, 
      'images/usgs_logo_black.png', 
      target_name, frames = I(4), I('irrigation'), I('publicsupply'), pause_delay = I('100250'))
      
  gifs/US_pub_use.gif:
    command: build_wu_gif(us_states, us_counties, us_county_dots, state_totals, plot_layout, 
      'images/usgs_logo_black.png', 
      target_name, frames = I(4), I('publicsupply'), I('industrial'),pause_delay = I('100250'))
      
  gifs/US_pie_use.gif:
    command: build_wu_gif(us_states, us_counties, us_county_dots, state_totals, plot_layout, 
      'images/usgs_logo_black.png', 
      target_name, frames = I(4), I('industrial'), I('pie'),pause_delay = I('100250'))


